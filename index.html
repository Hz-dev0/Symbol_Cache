<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drive Symbol Cache</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #fdf7f7 0%, #f5e7e7 100%);
            --primary-pink: #e6b4b4;   
            --text-main: #594a4a;      
            --accent-soft: rgba(230, 180, 180, 0.15); 
        }
        body { font-family: "Noto Sans TC", sans-serif; background: var(--bg-gradient); background-attachment: fixed; color: var(--text-main); margin: 0; padding: 20px; overflow-x: hidden; }
        .container { width: 100%; max-width: 500px; margin: 0 auto; background: transparent; }
        h2 { font-size: 1.1rem; margin: 0 0 12px 0; color: var(--primary-pink); letter-spacing: 1px; font-weight: 700; }
        .input-group { display: flex; gap: 5px; margin-bottom: 15px; }
        input { flex: 1; padding: 8px 12px; border: 1px solid rgba(230, 180, 180, 0.4); border-radius: 8px; outline: none; background: rgba(255, 255, 255, 0.6); font-size: 14px; color: var(--text-main); }
        button#addBtn { padding: 0 15px; cursor: pointer; background: var(--primary-pink); color: white; border: none; border-radius: 8px; font-size: 18px; }
        #symbolList { display: flex; flex-wrap: wrap; gap: 4px; list-style: none; padding: 0; margin: 0; }
        .symbol-item { padding: 4px 8px; background: var(--accent-soft); border-radius: 4px; cursor: pointer; user-select: none; font-size: 14px; }
        .symbol-item:hover { background: var(--primary-pink); color: white; }
        #status { font-size: 0.6rem; color: var(--primary-pink); margin-bottom: 5px; }
        #toast { visibility: hidden; background: rgba(89, 74, 74, 0.9); color: white; padding: 6px 14px; position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); border-radius: 50px; font-size: 12px; opacity: 0; transition: 0.3s; }
        #toast.show { visibility: visible; opacity: 1; }
    </style>
</head>
<body>
    <div class="container">
        <h2>üìÇ Drive Symbols</h2>
        <div id="status">Ê≠£Âú®Âæû Google Drive ËÆÄÂèñ...</div>
        <div class="input-group">
            <input type="text" id="symbolInput" placeholder="Êñ∞Â¢û‰∏¶ÂêåÊ≠•..." maxlength="30">
            <button id="addBtn">+</button>
        </div>
        <ul id="symbolList"></ul>
    </div>
    <div id="toast">Copied!</div>

<script>
    // üîó Ë≤ºÂÖ•‰Ω†ÁöÑ Google Apps Script Á∂≤ÂùÄ
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbyJolADGtpgaoU2fPUxM5ZgOArXLAyJh0RNjFCqD_mnJNi7B-UN0Dsu5RqF2HtajQ92/exec'; 

    const input = document.getElementById('symbolInput');
    const addBtn = document.getElementById('addBtn');
    const list = document.getElementById('symbolList');
    const statusText = document.getElementById('status');
    let savedSymbols = [];

    // Âæû Drive ËÆÄÂèñ
    async function loadData() {
        try {
            const res = await fetch(GAS_URL);
            savedSymbols = await res.json();
            statusText.innerText = "‚òÅÔ∏è Â∑≤ÈÄ£Á∑öËá≥ Google Drive";
            render();
        } catch (e) { statusText.innerText = "‚ùå ËÆÄÂèñÂ§±Êïó"; }
    }

    // Â≠òÂÖ• Drive
    async function saveData() {
        statusText.innerText = "‚è≥ ÂêåÊ≠•‰∏≠...";
        try {
            await fetch(GAS_URL, {
                method: 'POST',
                mode: 'no-cors', // GAS Ë∑®ÂüüÈôêÂà∂
                body: JSON.stringify(savedSymbols)
            });
            statusText.innerText = "‚òÅÔ∏è ÂêåÊ≠•ÊàêÂäü";
        } catch (e) { statusText.innerText = "‚ùå ÂêåÊ≠•Â§±Êïó"; }
    }

    function render() {
        list.innerHTML = '';
        savedSymbols.forEach((sym, index) => {
            const li = document.createElement('li');
            li.className = 'symbol-item';
            li.textContent = sym;
            li.onclick = () => { navigator.clipboard.writeText(sym); showToast("Â∑≤Ë§áË£Ω"); };
            li.oncontextmenu = (e) => {
                e.preventDefault();
                if (confirm(`Âà™Èô§„Äå${sym}„ÄçÔºü`)) {
                    savedSymbols.splice(index, 1);
                    render();
                    saveData();
                }
            };
            list.appendChild(li);
        });
    }

    addBtn.onclick = () => {
        if (input.value.trim()) {
            savedSymbols.push(input.value.trim());
            input.value = '';
            render();
            saveData();
        }
    };

    new Sortable(list, {
        animation: 150,
        onEnd: () => {
            savedSymbols = Array.from(list.children).map(li => li.textContent);
            saveData();
        }
    });

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg; t.classList.add("show");
        setTimeout(() => t.classList.remove("show"), 800);
    }

    loadData();
</script>
</body>
</html>